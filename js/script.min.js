let salesOrgMap = {
        DE: ["1010", "2200", "6110"],
        FR: ["2000", "2320", "6110"],
        NL: ["2320", "2420"],
        EN: ["1550", "2510", "2320"],
        ES: ["2610"],
        PT: ["2640"],
        IT: ["2710"],
        DK: ["2800"],
        NO: ["2900"],
        SE: ["3100"],
        EE: ["5110"],
        LV: ["5210"],
        LT: ["5310"],
        PL: ["5410"],
        FI: ["5710"],
        SI: ["5820"],
        HR: ["5830"],
        SK: ["5840"],
        CZ: ["5845"],
        HU: ["5850"],
        RO: ["5860"],
        BG: ["5870"],
        SER: ["5881"],
        ME: ["5895"],
    },
    salesOrgs = [
        { code: "1010", countryCode: "DE", countryName: "Germany" },
        { code: "1550", countryCode: "EN", countryName: "International" },
        { code: "2000", countryCode: "FR", countryName: "France" },
        { code: "2200", countryCode: "AT", countryName: "Austria" },
        { code: "2320", countryCode: "BE", countryName: "Belgium" },
        { code: "2420", countryCode: "NL", countryName: "Netherlands" },
        { code: "2510", countryCode: "UK", countryName: "United Kingdom" },
        { code: "2610", countryCode: "ES", countryName: "Spain" },
        { code: "2640", countryCode: "PT", countryName: "Portugal" },
        { code: "2710", countryCode: "IT", countryName: "Italy" },
        { code: "2800", countryCode: "DK", countryName: "Denmark" },
        { code: "2900", countryCode: "NO", countryName: "Norway" },
        { code: "3100", countryCode: "SE", countryName: "Sweden" },
        { code: "5110", countryCode: "EE", countryName: "Estonia" },
        { code: "5210", countryCode: "LV", countryName: "Latvia" },
        { code: "5310", countryCode: "LT", countryName: "Lithuania" },
        { code: "5410", countryCode: "PL", countryName: "Poland" },
        { code: "5710", countryCode: "FI", countryName: "Finland" },
        { code: "5820", countryCode: "SI", countryName: "Slovenia" },
        { code: "5830", countryCode: "HR", countryName: "Croatia" },
        { code: "5840", countryCode: "SK", countryName: "Slovakia" },
        { code: "5845", countryCode: "CZ", countryName: "Czech Republic" },
        { code: "5850", countryCode: "HU", countryName: "Hungary" },
        { code: "5860", countryCode: "RO", countryName: "Romania" },
        { code: "5870", countryCode: "BG", countryName: "Bulgaria" },
        { code: "5881", countryCode: "SER", countryName: "Serbia" },
        { code: "5895", countryCode: "ME", countryName: "Montenegro" },
        { code: "6000", countryCode: "EN", countryName: "International" },
        { code: "6110", countryCode: "CH", countryName: "Switzerland" },
    ],
    vendorInput = document.getElementById("vendor"),
    vendorListDiv = document.getElementById("vendorList"),
    vendorList = [
        "Euronic",
        "Club-3D-BV",
        "VIEWSONIC",
        "ADERIAN",
        "SAMSUNG-GSM",
        "NEOMOUNTS",
        "FRACTAL-DESIGN",
        "SEAMCOM",
        "MICROSOFT",
        "GoTo",
        "HP",
        "REFURB",
        "MICROSOFT-CSP",
        "MICROSOFT-SURFACE",
        "MICROSOFT-SURFACEHUB",
        "MICROSOFT-OEM",
        "XIAOMI-ECO",
        "XIAOMI",
        "LENOVO",
        "LENOVO-IDG",
        "LENOVO-ISG",
        "BRIDGE",
        "HP-SUPPLIES",
        "HP-PRINTING",
        "HP-COMPUTING",
        "HPE",
        "ARUBA",
        "DELL",
        "DELL-COMPUTERS",
        "CISCO",
        "TELEKOM-DEUTSCHLAND",
        "INTEL",
        "SEAGATE",
        "SAMSUNG",
        "SAMSUNG-MOBILE",
        "SAMSUNG-STORAGE",
        "ELECTRONIC ARTS",
        "APPLE",
        "APC",
        "LOGITECH",
        "WESTERN DIGITAL",
        "HUAWEI",
        "SOPHOS",
        "AMD",
        "CANON",
        "CANON-SCANNER",
        "CANON-SUPPLIES",
        "CANON-LFP",
        "FUJITSU",
        "FUJITSU-SCANNER",
        "FUJITSU-CCD",
        "FORTINET",
        "EATON",
        "BROTHER",
        "ASUS",
        "N-ABLE",
        "EPSON",
        "UNIFY",
        "ACER",
        "ACER-MONITOR",
        "ADOBE",
        "ZOTAC",
        "PATRONICS",
        "LG-DISPLAYS",
        "LG-SMART SIGNAGE",
        "ACRONIS",
        "IIYAMA",
        "MOTORLA",
        "CONTOUR DESIGN",
        "DEMANT SOUND",
        "VMWARE",
        "LISTAN",
        "GN-NETCOM",
        "ERGOTRON",
        "ALCATEL-LUCENT",
        "AOC INTERNATIONAL",
        "CONGSTAR",
        "IBM-CLOUD",
        "IBM-HARDWARE",
        "IBM-SOFTWARE",
        "KASPERKY LAB",
        "ZYXEL",
        "POLYCOM",
        "NORTONLIFELOCK",
        "LEXMARK",
        "ESET",
        "WATCHGUARD",
        "RAZER",
        "VEEAM",
        "DATTO",
        "MMD-MONITORS & DISPLAYS",
        "BOSE",
        "DICTOTA",
        "MITEL",
        "KINGSTON",
        "KYOCERA",
        "XEROX",
        "LINDY",
        "LEXWARE",
        "INNOVISION",
        "TRANSCEND",
        "EMC",
        "NEWSTAR",
        "QNAP SYSTEMS",
        "CHERRY",
        "ROOMZ",
        "CIRTRIX",
        "TARGUS",
        "NETGEAR",
        "REALWEAR",
        "SK HYNIX NAND PRODUCT SOLUTIONS",
        "TP-LINK",
        "BARCO",
        "ARCSERVE",
        "PROMETHEAN",
        "AVERPOINT",
        "ALLIED TELESIS",
        "LANCOM",
        "URBAN FACTORY",
        "ASSMANN ELECTRONIC",
        "GIGASET",
        "GIGASET-PRO",
        "GIGASET-CONSUMER",
        "ALSO",
        "MULTIVENDOR",
        "CAMBIUM NETWORKS",
        "3M",
        "NEC DISPLAY SOLUTIONS",
        "ESR",
        "NETAPP",
        "CROWDSTRIKE",
        "BLUEWALKER",
        "QUANTUM",
        "DELOCK",
        "OCTOGATE",
        "YEALINK",
        "TANDBERG DATA",
        "MSI",
        "INSYS",
        "NCP",
        "SANDBERG",
        "DYNABOOK",
        "MICROFOCUS",
        "SUPER MICRO COMPUTER",
        "VERTIV",
        "PHILIPS",
        "D-LINK",
        "GIGABYTE",
        "I-TEC",
        "AUREA SOFTWARE",
        "SNOM TECHNOLOGY",
        "SONY",
        "SILICON POWER COMPUTER & COMMUNICATION",
        "KONFTEL AB",
        "FANVIL",
        "BELKIN",
        "GEMBIRD",
        "AVM",
        "PNY",
        "NET-AT-WORK",
        "BENQ",
        "AGFEO",
        "BINTEC-ELMEG",
        "MATERIALISE",
        "STATIC CONTROL",
        "KFA2",
        "MGE-USV SYSTEME",
        "SENNHEISER",
        "LACIE",
        "C4B",
        "UBIQUITI NETWORKS",
        "FELLOWES",
        "AUERSWALD",
        "SEH",
        "VADE SECURE",
        "BARRACUDA",
        "NUTANIX",
        "OKI",
        "SYNOLOGY",
        "OPTOMA",
        "SANDISK",
        "INTRA2NET",
        "ESTOS",
        "IC INTRACOM",
        "EVER",
        "LANBERG",
        "DROPBOX",
        "SILEX TECHNOLOGY EUROPE",
        "LEITZ ACCO BRANDS",
        "PALIT",
        "SAPPHIRE",
        "RAIDSONIC",
        "XFX",
        "CHIEFTEC",
        "WACOM",
        "TOSHIBA EUROPE",
        "EFB",
        "3DCONNEXION",
        "PANASONIC",
        "CORSAIR",
        "AV STUMPFL",
        "PIXMINDS",
        "CANDY",
        "PEERLESS-AV",
        "OTTER PRODUCTS",
        "PATRIOT MEMORY",
        "TRUST",
        "AVER INDORMATION",
        "STARTECH.COM",
        "POWERCOLOR TUL",
        "PORT DESIGNS",
        "QOLTEC",
        "APACER",
        "MIKROTIK",
        "A-DATA",
        "NVIDIA",
        "GAINWARD EUROPE",
        "SHARP",
        "PARAT",
        "GO EUROPE",
        "GREEN CELL",
        "HAMA",
        "HITACHI-LG",
        "TEAM GROUP",
        "GETT GERÄTETECHNIK",
        "SECOMP",
        "INTER-TECH",
        "RITTAL",
        "GFI SOFTWARE",
        "AIRSLATE",
        "ZEBRA",
        "EXTRALINK",
        "1&1 IONOS",
        "CHECK POINT",
        "JABRA",
        "REINER KARTENGERÄTE",
        "COOLER MASTER",
        "MEDION",
        "NATEC",
        "AKYGA",
        "SANUS",
        "JJ-COMPUTER",
        "INNOFIL3D",
        "GREENBONE",
        "COREL",
        "WITHSECURE",
        "SONOS",
        "ASROCK",
        "ZEPP",
        "SOLARWINDS",
        "MCAFEE IRELAND",
        "AXIS COMMUNICATIONS",
        "KEMP TECHNOLOGIES",
        "WIKO",
        "TECHLY",
        "NETRACK",
        "TRACER",
        "RSA SECURITY",
        "ART",
        "KRAMER",
        "BASF 3D",
        "LOGILINK",
        "DATA AND MORE",
        "ZALMAN",
        "ACTIVISION",
        "WITHINGS",
        "INTEGRAL MEMORY PLC",
        "DORO",
        "CYBER POWER",
        "CENOR",
        "GOODRAM",
        "DYEMANSION",
        "TP VISION",
        "BMG",
        "PEACOCK",
        "SMS EVOKO GROUP",
        "A4TECH",
        "VERBATIM",
        "HGST",
        "EVE SYSTEMS",
        "ANKI",
        "BLIZZARD ENTERTAINMENT",
        "PARTNER CARE EUROPE",
        "ENERGENIE BY GEMBIRD",
        "TWELVE SOUTH",
        "MILESTONES SYSTEMS A/S",
        "LINKSYS",
        "MEDIA TECH",
        "TEAMVIEWER",
        "TECHLY PRO",
        "CREAFORM",
        "PRINTRONIX",
        "PANDUIT",
        "ATEN",
        "4WORLD",
        "SUUNTO",
        "MW",
        "BLAUPUNKT",
        "CSB",
        "RICOH",
        "CLOUD TECHNOLOGY SOLUTIONS",
        "COMDIS",
        "NEXT CONCEPT",
        "REALME",
        "KONICA MINOLTA",
        "DIGITUS",
        "XTON",
        "EIZO",
        "CRICUT",
        "LETSIGNIT",
        "NEOLT FACTORY",
        "PELCO",
        "MANHATTAN",
        "ELITE SCREENS",
        "PLENOM",
        "EDIMAX",
        "AZON",
        "VIDIS S.A.",
        "APPLICATIELINK",
        "IVANTI",
        "ZIMBRA",
        "ESPERANZA",
        "INCASE",
        "SMART TECHNOLOGIES ULC",
        "GRIFFIN",
        "WHITENERGY",
        "TENDA TECHNOLOGY",
        "VAXTOR",
        "HISENSE",
        "DIGICERT",
        "VIVO MOBILE COMMUNICATION",
        "QS SOLUTIONS",
        "PERSONDATASUPPORT",
        "DROPSUITE",
        "CRAFTUNIQUE",
        "INCIPIO",
        "INNO3D",
        "TALLY GENICOM",
        "PRICE INTERNATIONAL",
        "ORVALDI",
        "G.SKILL",
    ],
    reverseVendorMap = new Map();
function renderVendorList(t) {
    (vendorListDiv.innerHTML = ""), reverseVendorMap.clear();
    var e = vendorList.filter((e) => e.toLowerCase().startsWith(t.toLowerCase()));
    !t.trim() || 0 === e.length
        ? (vendorListDiv.style.display = "none")
        : (e.forEach((e) => {
              var t = document.createElement("div");
              t.className = "autocomplete-item";
              let a = e.replace(/\s+/g, "-");
              (t.textContent = a),
                  reverseVendorMap.set(a, e),
                  t.addEventListener("click", () => {
                      (vendorInput.value = a), (vendorListDiv.style.display = "none"), checkAndGenerate();
                  }),
                  vendorListDiv.appendChild(t);
          }),
          (vendorListDiv.style.display = "block"));
}
function removeVendorActive(e) {
    e.forEach((e) => e.classList.remove("active"));
}
vendorInput.addEventListener("input", function () {
    let t = this.value;
    var e;
    t ? ((e = vendorList.find((e) => e.toLowerCase() === t.toLowerCase())) ? ((this.value = e), (vendorListDiv.style.display = "none")) : renderVendorList(t)) : (vendorListDiv.style.display = "none");
}),
    vendorInput.addEventListener("blur", () => {
        setTimeout(() => {
            var e = findBestMatchingVendor(vendorInput.value);
            (vendorInput.value = e), (vendorListDiv.style.display = "none"), checkAndGenerate();
        }, 200);
    }),
    document.addEventListener("click", function (e) {
        vendorListDiv.contains(e.target) || e.target === vendorInput || (vendorListDiv.style.display = "none");
    });
let salesOrgPopup = document.getElementById("salesOrgPopup"),
    languageInput = document.getElementById("languageInput"),
    languageList = document.getElementById("languageList"),
    languageOptions =
        (languageInput.addEventListener("click", () => {
            var e = languageInput.value;
            languageOptions.includes(e) && showSalesOrgPopup(e);
        }),
        ["DE", "FR", "NL", "EN", "ES", "IT", "DK", "NO", "SE", "EE", "LV", "LT", "PL", "PT", "FI", "SI", "HR", "SK", "CZ", "HU", "RO", "BG", "SER", "ME"]);
function handleSingleSalesOrg(e) {
    var t = salesOrgMap[e] || [];
    return 1 === t.length && ((salesOrgPopup.style.display = "none"), renderTableByLanguageAndCode(e, t[0]), generateNames(e, t[0]), !0);
}
function showSalesOrgPopup(a) {
    var e = salesOrgMap[a] || [];
    e.length <= 1
        ? (salesOrgPopup.style.display = "none")
        : ((salesOrgPopup.innerHTML = ""),
          e.forEach((e) => {
              var t = document.createElement("div");
              (t.className = "autocomplete-item"),
                  (t.textContent = e),
                  t.addEventListener("click", () => {
                      (salesOrgPopup.style.display = "none"), renderTableByLanguageAndCode(a, e), generateNames(a, e);
                  }),
                  salesOrgPopup.appendChild(t);
          }),
          (salesOrgPopup.style.display = "block"));
}
function renderLanguageList(t) {
    languageList.innerHTML = "";
    var e = languageOptions.filter((e) => e.startsWith(t));
    e.length <= 1
        ? (languageList.style.display = "none")
        : (e.forEach((e) => {
              var t = document.createElement("div");
              (t.className = "autocomplete-item"),
                  (t.textContent = e),
                  t.addEventListener("click", () => {
                      (languageInput.value = e), (languageList.style.display = "none"), handleSingleSalesOrg(e) || showSalesOrgPopup(e);
                  }),
                  languageList.appendChild(t);
          }),
          (languageList.style.display = "block"));
}
languageInput.addEventListener("input", () => {
    var e = languageInput.value.trim().toUpperCase();
    e && languageOptions.includes(e) && (emailLanguageInput.setAttribute("value", ""), (emailLanguageInput.value = "")),
        e ? (languageOptions.includes(e) ? ((languageInput.value = e), (languageList.style.display = "none"), handleSingleSalesOrg(e) || showSalesOrgPopup(e)) : renderLanguageList(e)) : ((languageList.style.display = "none"), (salesOrgPopup.style.display = "none"));
}),
    languageInput.addEventListener("focus", () => {
        var e = languageInput.value.trim().toUpperCase();
        e && (e && languageOptions.includes(e) && (emailLanguageInput.setAttribute("value", ""), (emailLanguageInput.value = "")), languageOptions.includes(e) ? handleSingleSalesOrg(e) || showSalesOrgPopup(e) : renderLanguageList(e));
    });
let emailLanguageInput = document.getElementById("emailLanguageInput"),
    emailLanguageList = document.getElementById("emailLanguageList"),
    emailSalesOrgPopup = document.getElementById("emailSalesOrgPopup");
function renderEmailLanguageList(t) {
    emailLanguageList.innerHTML = "";
    var e = languageOptions.filter((e) => e.startsWith(t));
    e.length <= 1
        ? (emailLanguageList.style.display = "none")
        : (e.forEach((e) => {
              var t = document.createElement("div");
              (t.className = "autocomplete-item"),
                  (t.textContent = e),
                  t.addEventListener("click", () => {
                      (emailLanguageInput.value = e), (emailLanguageList.style.display = "none"), showEmailSalesOrgPopup(e);
                  }),
                  emailLanguageList.appendChild(t);
          }),
          (emailLanguageList.style.display = "block"));
}
function showEmailSalesOrgPopup(a) {
    var e,
        t = salesOrgMap[a] || [];
    1 === t.length
        ? ((e = t[0]), (emailSalesOrgPopup.style.display = "none"), renderTableByLanguageAndCode(a, e))
        : ((emailSalesOrgPopup.innerHTML = ""),
          t.forEach((e) => {
              var t = document.createElement("div");
              (t.className = "autocomplete-item"),
                  (t.textContent = e),
                  t.addEventListener("click", () => {
                      (emailSalesOrgPopup.style.display = "none"), renderTableByLanguageAndCode(a, e);
                  }),
                  emailSalesOrgPopup.appendChild(t);
          }),
          (emailSalesOrgPopup.style.display = "block"));
}
function handleSingleEmailSalesOrg(e) {
    var t = emailSalesOrgPopup[e] || [];
    return 1 === t.length && ((emailSalesOrgPopup.style.display = "none"), renderTableByLanguageAndCode(e, t[0]), !0);
}
emailLanguageInput.addEventListener("input", function () {
    var e = emailLanguageInput.value.trim().toUpperCase();
    e ? (languageOptions.includes(e) ? ((emailLanguageInput.value = e), (emailLanguageList.style.display = "none"), handleSingleEmailSalesOrg(e) || showEmailSalesOrgPopup(e)) : renderEmailLanguageList(e)) : ((emailLanguageList.style.display = "none"), (emailSalesOrgPopup.style.display = "none"));
}),
    emailLanguageInput.addEventListener("focus", () => {
        var e = emailLanguageInput.value.trim().toUpperCase();
        e && (languageOptions.includes(e) ? handleSingleEmailSalesOrg(e) || showEmailSalesOrgPopup(e) : renderEmailLanguageList(e));
    }),
    document.addEventListener("click", function (e) {
        emailLanguageList.contains(e.target) || emailSalesOrgPopup.contains(e.target) || e.target === emailLanguageInput || ((emailLanguageList.style.display = "none"), (emailSalesOrgPopup.style.display = "none"));
    }),
    document.addEventListener("click", (e) => {
        languageList.contains(e.target) || e.target === languageInput || (languageList.style.display = "none"), salesOrgPopup.contains(e.target) || e.target === languageInput || (salesOrgPopup.style.display = "none");
    });
let dataMap = {
    DE: {
        1010: { text1: "ALSO Newsletter", text2: "info@email.also.com", text3: "info@also.com", email: "bueckendorf@metacomp.de", ctaText: "MEHR ERFAHREN" },
        2200: { text1: "ALSO Newsletter", text2: "info@email.also.com", text3: "oedataadminreturns-at@also.com", email: "georg.henke@henke.co.at", ctaText: "MEHR ERFAHREN" },
        6110: { text1: "ALSO News", text2: "alsonews-ch@email.also.com", text3: "alsonews-ch@news.also.com", email: "elvis.muriniti@swisspro.ch", ctaText: "MEHR ERFAHREN" },
    },
    FR: {
        2e3: { text1: "ALSO France", text2: "marketing-fr@email.also.com", text3: "noreply-fr@also.com", email: "jlaroussinie@ecotic.fr", ctaText: "VOIR LE PRODUIT" },
        2320: { text1: "ALSO Belgium", text2: "newsletter.be@email.also.com", text3: "newsletter.be@also.com", email: "jeroen@autosoft.be", ctaText: "VOIR LE PRODUIT" },
        6110: { text1: "ALSO News", text2: "alsonews-ch@email.also.com", text3: "alsonews-ch@news.also.com", email: "claude.christophi@birdnet.ch", ctaText: "VOIR LE PRODUIT" },
    },
    NL: {
        2320: { text1: "ALSO Belgium", text2: "newsletter.be@email.also.com", text3: "newsletter.be@also.com", email: "kristof.de.coninck@becosoft.be", ctaText: "BESTEL NU" },
        2420: { text1: "ALSO Nederland B.V.", text2: "nieuwsbrief@email.also.com", text3: "info.nl@also.com", email: "elyse.vanrossum@also.com", ctaText: "BESTEL NU" },
    },
    EN: {
        1550: { text1: "ALSO Newsletter", text2: "info@email.also.com", text3: "info@also.com", email: "senait.isaac@also.com", ctaText: "LEARN MORE" },
        2510: { text1: "ALSO Newsletter", text2: "info@email.also.com", text3: "info@also.com", email: "senait.isaac@also.com", ctaText: "LEARN MORE" },
        2320: { text1: "ALSO Belgium", text2: "newsletter.be@email.also.com", text3: "newsletter.be@also.com", email: "newsletter.be@also.com", ctaText: "LEARN MORE" },
    },
    ES: { 2610: { text1: "ALSO Newsletter", text2: "info@email.also.com", text3: "info.es@also.com", email: "juan.cabrera@bps.com.es", ctaText: "APRENDE MÁS" } },
    IT: { 2710: { text1: "ALSO Newsletter", text2: "info@email.also.com", text3: "no-reply@also.com", email: "natalino@gigahertz.it", ctaText: "MAGGIORI INFORMAZIONI" } },
    DK: { 2800: { text1: "ALSO A/S", text2: "info@email.also.com", text3: "marketing.danmark@also.com", email: "info@moduldata.dk", ctaText: "LÆR MERE" } },
    NO: { 2900: { text1: "ALSO Nyhetsbrev", text2: "info@email.also.com", text3: "marketing.norge@also.com", email: "rikard.faanes@atea.no", ctaText: "KJØP" } },
    SE: { 3100: { text1: "ALSO Nyhetsbrev", text2: "info@email.also.com", text3: "Marketing.Sverige@also.com", email: "johan@itbiten.se", ctaText: "LÄR MER" } },
    EE: { 5110: { text1: "ALSO Eesti", text2: "info@email.also.com", text3: "ee-mailserver@also.com", email: "ilmar@fivepoint.ee", ctaText: "UURI LISAKS" } },
    LV: { 5210: { text1: "ALSO Jaunumi", text2: "info@email.also.com", text3: "LV-marketing@also.com", email: "lauris.v@tomega.lv", ctaText: "PIRKT" } },
    LT: { 5310: { text1: "ALSO Newsletter", text2: "info@email.also.com", text3: "info@also.com", email: "sigitas@ella.lt", ctaText: "SUŽINOKITE DAUGIAU" } },
    PL: { 5410: { text1: "ALSO Newsletter", text2: "newsletter@email.also.com", text3: "newsletter@alsopolska.pl", email: "biuro@cybertom.pl", ctaText: "DOWIEDZ SIȨ WIȨCEJ" } },
    FI: { 5710: { text1: "ALSO Finland Oy", text2: "FI-mailserver@email.also.com", text3: "FI-mailserver@also.com", email: "anne.kangas@ta.fi", ctaText: "LUE LISÄÄ" } },
    SI: { 5820: { text1: "ALSO Slovenija", text2: "info@email.also.com", text3: "Info.si@also.com", email: "borut.jurcevic@tend.si", ctaText: "VEČ INFORMACIJ" } },
    HR: { 5830: { text1: "ALSO Croatia", text2: "marketing.hr@email.also.com", text3: "Info.ALSOCroatia@also.com", email: "prodaja@biro-media.hr", ctaText: "SAZNAJTE VIŠE" } },
    SK: { 5840: { text1: "ALSO Newsletter", text2: "info-sk@email.also.com", text3: "info-sk@also.com", email: "suhaj@zero.sk", ctaText: "UČ SA VIAC" } },
    CZ: { 5845: { text1: "ALSO Newsletter", text2: "info-cz@email.also.com", text3: "info-cz@also.com", email: "forcomp@seznam.cz", ctaText: "DALŠÍ INFORMACE" } },
    HU: { 5850: { text1: "ALSO Newsletter", text2: "info@email.also.com", text3: "info@also.com", email: "laszlo.farago@lemonet.hu", ctaText: "TUDJON MEG TÖBBET" } },
    RO: { 5860: { text1: "ALSO Technology Romania", text2: "info@email.also.com", text3: "info@email.also.com", email: "florin.tirca@vexio.ro", ctaText: "AFLAȚI MAI MULTE" } },
    BG: { 5870: { text1: "ALSO Bulgaria Ltd.", text2: "office.bg@email.also.com", text3: "office.bg@also.com", email: "a.petrov@econsult.bg", ctaText: "НАУЧЕТЕ ПОВЕЧЕ" } },
    SER: { 5881: { text1: "ALSO Newsletter", text2: "info@email.also.com", text3: "info@also.com", email: "info@also.com", ctaText: "LEARN MORE" } },
    ME: { 5895: { text1: "ALSO Newsletter", text2: "info@email.also.com", text3: "info@also.com", email: "info@also.com", ctaText: "LEARN MORE" } },
    PT: { 2640: { text1: "ALSO Newsletter", text2: "info@email.also.com", text3: "info@also.com", email: "vasco@mvti.pt", ctaText: "Comprar" } },
};
function capitalizeCTA(e) {
    return e
        .toLowerCase()
        .split(" ")
        .map((e) => e.charAt(0).toUpperCase() + e.slice(1))
        .join(" ");
}
Object.values(dataMap).forEach((e) => {
    Object.values(e).forEach((e) => {
        e.ctaText && (e.ctaText = capitalizeCTA(e.ctaText));
    });
});
let languageSelect = document.getElementById("languageInput"),
    codeInput = document.getElementById("codeInput"),
    submitBtn = document.getElementById("submitBtn"),
    resultTable = document.getElementById("resultTable"),
    tableBody = document.getElementById("tableBody");
function renderTableByLanguageAndCode(e, t) {
    var a = (dataMap[e] || {})[t];
    a
        ? ((tableBody.innerHTML = `
            <tr>
                <td>${t}_${e}</td>
                <td>${a.text1}</td>
                <td>${a.text2}</td>
                <td>${a.text3}</td>
                <td>${a.email}</td>
                <td><strong>${a.ctaText}</strong></td>
            </tr>
        `),
          (resultTable.style.display = "table"))
        : ((tableBody.innerHTML = ""), (resultTable.style.display = "none"));
}
function renderTableByLanguage(a) {
    var e = salesOrgMap[a] || [];
    let n = dataMap[a] || {},
        o = "",
        l = !1;
    e.forEach((e) => {
        var t = n[e];
        t &&
            ((l = !0),
            (o += `
            <tr>
              <td>${e}_${a}</td>
              <td>${t.text1}</td>
              <td>${t.text2}</td>
              <td>${t.text3}</td>
              <td>${t.email}</td>
              <td><strong>${t.ctaText}</strong></td>
            </tr>
          `));
    }),
        l ? ((tableBody.innerHTML = o), (resultTable.style.display = "table")) : ((tableBody.innerHTML = ""), (resultTable.style.display = "none"));
}
function getCurrentWeek() {
    var e = new Date(),
        t = new Date(e.getFullYear(), 0, 1),
        t = e - t + 6e4 * (t.getTimezoneOffset() - e.getTimezoneOffset());
    return String(Math.ceil(t / 6048e5)).padStart(2, "0");
}
function getMMDD() {
    var e = new Date();
    return String(e.getMonth() + 1).padStart(2, "0") + String(e.getDate()).padStart(2, "0");
}
function checkAndGenerate() {
    var e = document.getElementById("languageInput"),
        t = document.getElementById("idTicket"),
        a = document.getElementById("campaignID"),
        n = document.getElementById("bannerProofSection"),
        o = document.querySelector(".marketoSection"),
        l = document.getElementById("bannerSize"),
        r = document.getElementById("typeBanner"),
        i = document.getElementById("bannerPositonSection"),
        r = r?.value.trim(),
        t = t?.value.trim(),
        a = a?.value.trim(),
        s = e.value.trim().toUpperCase(),
        d = s && languageOptions.includes(s),
        c = ["vendor", "campaignName", "programCode", "customDate"].every((e) => {
            e = document.getElementById(e);
            return e && "" !== e.value.trim();
        });
    (n.style.display = "" !== r && "" !== t && d ? "block" : "none"),
        (i.style.display = l && "" !== l.value.trim() && d ? "block" : "none"),
        (o.style.display = a ? "block" : "none"),
        c ? (e.classList.remove("disabled"), (e.disabled = !1), d && 1 === (n = salesOrgMap[s] || []).length && (renderTableByLanguageAndCode(s, n[0]), generateNames(s, n[0]))) : (e.classList.add("disabled"), (e.disabled = !0));
}
document.addEventListener("DOMContentLoaded", function () {
    function a(e, t = "Copied!") {
        var a = e.querySelector(".copy-tooltip");
        a && a.remove();
        let n = document.createElement("div");
        (n.className = "copy-tooltip"),
            (n.textContent = t),
            e.appendChild(n),
            requestAnimationFrame(() => n.classList.add("show")),
            setTimeout(() => {
                n.classList.remove("show"), setTimeout(() => n.remove(), 300);
            }, 5e3);
    }
    document.getElementById("resultTable").addEventListener("click", function (e) {
        let t = e.target.closest("td");
        t &&
            ((e = t.innerText.trim()),
            navigator.clipboard.writeText(e).then(() => {
                a(t);
            }));
    }),
        document.getElementById("proofNameResult").addEventListener("click", function (e) {
            let t = e.target.closest(".copy-text");
            t &&
                ((e = t.textContent.trim()),
                navigator.clipboard
                    .writeText(e)
                    .then(() => {
                        a(t);
                    })
                    .catch((e) => {
                        console.error("Copy failed:", e);
                    }));
        }),
        document.getElementById("bannerPositionResult").addEventListener("click", function (e) {
            let t = e.target.closest(".copy-text");
            t &&
                ((e = t.textContent.trim()),
                navigator.clipboard
                    .writeText(e)
                    .then(() => {
                        a(t);
                    })
                    .catch((e) => {
                        console.error("Copy failed:", e);
                    }));
        }),
        document.getElementById("tableBodyName").addEventListener("click", function (e) {
            let t = e.target.closest(".email-name");
            t &&
                ((e = t.textContent.trim()),
                navigator.clipboard
                    .writeText(e)
                    .then(() => {
                        a(t);
                    })
                    .catch((e) => {
                        console.error("Copy failed:", e);
                    }));
        });
    let t = document.getElementById("bannerPosition"),
        n = document.getElementById("bannerSize");
    document.getElementById("bannerPositions");
    let o = document.getElementById("bannerPosition");
    (o.innerHTML = '<option value="">-- Select Position --</option>'),
        Object.keys(bannerToSizeMapping).forEach((e) => {
            var t = document.createElement("option");
            (t.value = e), (t.textContent = e), o.appendChild(t);
        }),
        t.addEventListener("input", () => {
            var e = t.value,
                e = bannerToSizeMapping[e] || [];
            (n.innerHTML = '<option value="">-- Select Size --</option>'),
                e.forEach((e) => {
                    var t = document.createElement("option");
                    (t.value = e), (t.textContent = e), n.appendChild(t);
                });
        });
}),
    document.addEventListener("DOMContentLoaded", () => {
        ["vendor", "campaignName", "campaignID", "idTicket", "programCode", "bannerPosition", "bannerSize", "customDate", "languageInput"].forEach((e) => {
            e = document.getElementById(e);
            e && (e.addEventListener("input", checkAndGenerate), e.addEventListener("change", checkAndGenerate));
        }),
            checkAndGenerate();
    });
var bannerToSizeMapping = {
    "acmp-dashboard-banner": ["510x170", "1150x170", "1150x360"],
    "email-banner": ["640x90", "620x180"],
    "external-display-banner": ["160x600", "120x600", "300x250", "728x90"],
    "shop-basket-banner": ["300x100"],
    "shop-compare-banner": ["300x100"],
    "shop-daily-news": ["510x170", "120x600"],
    "shop-dashboard": ["510x170"],
    "shop-dashboard-mega": ["1150x360"],
    "shop-dashboard-super": ["1150x170", "1150x360"],
    "shop-footer-banner": ["185x90"],
    "shop-layer-banner": ["800x500"],
    "shop-notepad-banner": ["300x100"],
    "shop-order-confirmation-banner": ["510x400"],
    "shop-popup-banner": ["960x500", "800x500"],
    "shop-product-detail": ["920x90", "510x170"],
    "social-banner": ["1200x628"],
    "today-email-special-banner": ["620x300"],
    "today-email-topbanner": ["670x620"],
    "website-deals&discoveries-banner": ["510x170"],
    "website-deals&discoveries-teaser-image": ["703x410"],
    "website-deals&discoveries-hero-image": ["1260x523"],
    "website-homepage-banner": ["1012x570", "920x90", "1920x575"],
    "website-otherpage-banner": ["1012x570", "920x90", "1920x575"],
};
function generateProofName(e, t) {
    var a = document.getElementById("vendor").value.toLowerCase(),
        n = document.getElementById("campaignName").value.trim().replace(/\s+/g, "_"),
        o = (document.getElementById("campaignID").value.trim(), document.getElementById("idTicket").value.trim()),
        l = ((typeBanner = document.getElementById("typeBanner").value), document.getElementById("customDate").value),
        l = l ? new Date(l) : new Date(),
        t = languageInput.value.trim().toUpperCase() || t || e,
        e = getWeekNumber(l);
    typeBanner
        ? ((l = `${t}_${e}_${typeBanner}_${a}_${n}_` + o),
          (document.getElementById("proofNameResult").innerHTML = `
       <div class="copy-text">
            <p>${l}</p>
        </div>
    `),
          document.getElementById("typeBanner").addEventListener("change", () => {
              var e,
                  t = document.getElementById("languageInput").value.trim().toUpperCase();
              t && languageOptions.includes(t) && 0 < (e = salesOrgMap[t] || []).length && generateProofName(t, e[0]);
          }))
        : (document.getElementById("proofNameResult").innerHTML = "");
}
function generatePositionBannerName(e, t) {
    var a = document.getElementById("vendor").value.toLowerCase(),
        n = document
            .getElementById("campaignName")
            .value.trim()
            .split(/\s+/)
            .map((e) => e.charAt(0).toUpperCase() + e.slice(1).toLowerCase())
            .join(""),
        o = document.getElementById("campaignID").value.trim(),
        l = document.getElementById("bannerPosition").value.trim(),
        r = document.getElementById("bannerSize").value.trim(),
        i = document.getElementById("customDate").value,
        i = i ? new Date(i) : new Date(),
        i = i.getFullYear().toString().slice(-2) + "CW" + getWeekNumber(i),
        t = (t || (salesOrgMap[e] && salesOrgMap[e][0]) || "0000") + `_${a}_${i}_${e}${n}_${o}_${l}_` + r;
    document.getElementById("bannerPositionResult").innerHTML = `
        <div class="copy-text">
            <p>${t}</p>
        </div>
    `;
}
function getLangFromSalesOrg(e) {
    for (var t in salesOrgMap) if (salesOrgMap[t].includes(e)) return t;
    return "";
}
function autoParseCampaignInfo() {
    var { langCode: e, vendor: t, campaign: a } = parseCampaignInfo(document.getElementById("campaignName").value);
    a && (document.getElementById("campaignName").value = a), t && (document.getElementById("vendor").value = t), e && (((a = document.getElementById("languageInput")).value = e), a.dispatchEvent(new Event("input", { bubbles: !0 })));
}
function normalize(e) {
    return e.toLowerCase();
}
function findBestMatchingVendor(e) {
    if (!e.trim()) return "";
    let n = e.toLowerCase();
    var t = vendorList
        .map((e) => {
            let t = e.toLowerCase(),
                a = 0;
            return (
                n === t
                    ? (a = 100)
                    : n.includes(t)
                    ? (a = 80)
                    : t.includes(n)
                    ? (a = 60)
                    : (n.match(/[a-z0-9]+/g) || []).forEach((e) => {
                          t.includes(e) && (a += e.length);
                      }),
                { original: e, score: a }
            );
        })
        .filter((e) => 0 < e.score)
        .sort((e, t) => t.score - e.score);
    if (!t.length) return "";
    let a = t[0].score;
    t = t.filter((e) => e.score === a);
    if (1 !== t.length) return renderVendorList(e), "";
    var o,
        l,
        r = t[0].original;
    renderVendorList(r);
    for ([o, l] of reverseVendorMap.entries()) if (l.toLowerCase() === r.toLowerCase()) return o;
    return r.replace(/\s+/g, "-");
}
function getRenderedVendor(e) {
    for (var [t, a] of vendorMap.entries()) if (a === e) return t;
    return e.replace(/\s+/g, "-");
}
function parseCampaignInfo(e) {
    var e = e.split("-").slice(1).join("-").split("*")[0].trim().split(/\s+/),
        t = e.find((e) => /^\d{4}$/.test(e)),
        a = getLangFromSalesOrg(t),
        t = e.indexOf(t),
        n = e.findIndex((e) => /Q\d/i.test(e));
    let o = "",
        l = "";
    return (
        -1 !== t && -1 !== n && t < n && ((t = e.slice(t + 1, n).join(" ")), (o = findBestMatchingVendor(t))),
        -1 !== n && ((t = e.slice(n + 1)), (l = t.join(" "))),
        (l = l
            .split(/\s+/)
            .map((e) => e.charAt(0).toUpperCase() + e.slice(1).toLowerCase())
            .join(" ")
            .trim()),
        { langCode: a || "", vendor: o, campaign: l }
    );
}
function generateNames(e, t) {
    var a = parseCampaignInfo(document.getElementById("campaignName").value);
    a.campaign && (document.getElementById("campaignName").value = a.campaign), a.vendor && (document.getElementById("vendor").value = a.vendor), a.langCode && (document.getElementById("languageInput").value = a.langCode);
    let o = document.getElementById("vendor").value.toLowerCase(),
        l = document.getElementById("campaignName").value,
        r = document.getElementById("languageInput").value,
        i = document.getElementById("campaignID").value.trim(),
        s = document.getElementById("programCode").value;
    var a = document.getElementById("customDate").value,
        a = a ? new Date(a) : new Date(),
        n = a.getFullYear().toString().slice(-2);
    let d = "" + String(a.getMonth() + 1).padStart(2, "0") + String(a.getDate()).padStart(2, "0"),
        c = n + "CW" + getWeekNumber(a),
        m = document.getElementById("tableBodyName");
    m.innerHTML = "";
    n = salesOrgMap[r] || [];
    n.forEach((t) => {
        var e = salesOrgs.find((e) => e.code === t),
            e = e ? e.countryName : "Unknown",
            a = `${t}-${s}-${c}-${d}-${o}-${r}${l}-` + i,
            n = document.createElement("tr");
        (n.innerHTML = `
            <td>${t}_${r}</td>
            <td>${e}</td>
            <td><span class="email-name">${a}</span></td>
        `),
            m.appendChild(n);
    }),
        generateProofName(r, n[0]),
        generatePositionBannerName(r, n[0]);
}
function getWeekNumber(e) {
    (e = new Date(Date.UTC(e.getFullYear(), e.getMonth(), e.getDate()))).setUTCDate(e.getUTCDate() + 4 - (e.getUTCDay() || 7));
    var t = new Date(Date.UTC(e.getUTCFullYear(), 0, 1)),
        e = Math.ceil(((e - t) / 864e5 + 1) / 7);
    return String(e).padStart(2, "0");
}
document.getElementById("bannerPosition").addEventListener("change", function () {
    var e = this.value;
    let a = document.getElementById("bannerSize");
    (a.innerHTML = '<option value="">-- Select Size --</option>'),
        bannerToSizeMapping[e] &&
            bannerToSizeMapping[e].forEach((e) => {
                var t = document.createElement("option");
                (t.value = e), (t.textContent = e), a.appendChild(t);
            });
}),
    document.getElementById("bannerSize").addEventListener("change", () => {
        var e,
            t = document.getElementById("languageInput").value.trim().toUpperCase();
        t && languageOptions.includes(t) && 0 < (e = salesOrgMap[t] || []).length && generatePositionBannerName(t, e[0]);
    }),
    document.addEventListener("DOMContentLoaded", () => {
        var e = new Date().toISOString().split("T")[0],
            e = ((document.getElementById("customDate").value = e), document.getElementById("typeBanner"));
        e &&
            e.addEventListener("input", () => {
                var e = document.getElementById("languageInput").value.trim().toUpperCase(),
                    t = salesOrgMap[e] || [];
                generateProofName(e, 1 === t.length ? t[0] : "");
            });
    });
